<html>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="bulma.css"/>
	<meta charset="utf-8" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
	<link rel="stylesheet" href="https://static.runoob.com/assets/foundation-icons/foundation-icons.css">
	<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
	<script src="https://cdn.bootcss.com/vue/2.5.16/vue.min.js"></script>
	<script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
	<script src="jquery.js"></script>
	<head>
		<title>云音乐</title>

		<style>
			img{
			   animation:myfirst 20s linear 2s infinite alternate;
			   -webkit-animation:myfirst 20s linear 0s infinite normal;
			   -moz-animation: myfirst 20s linear 0s infinite normal;
			   -o-animation: myfirst 20s linear 0s infinite normal;
			   }
			   @keyframes myfirst{
			   0%{
			   transform: rotate(0deg);
			   }
			   100%{
			   transform: rotate(360deg);
			   }
		   }
   
		   .rotate{
			   animation:myfirst 20s linear 2s infinite alternate;
			   -webkit-animation:myfirst 20s linear 0s infinite normal;
			   -moz-animation: myfirst 20s linear 0s infinite normal;
			   -o-animation: myfirst 20s linear 0s infinite normal;
			   }
			   @keyframes myfirst{
			   0%{
			   transform: rotate(0deg);
			   }
			   100%{
			   transform: rotate(360deg);
			   }
		   }
   
		   html,body{
			   background-color:#f47983;
			   width: 100%;
			   height: 100%;
		   }
		   .mactive{
			   color: rgb(244, 121, 131);
		   }
		   .mnormal{
			   color: grey;
		   }
		   .ccard{
			   position: fixed;
			   top: 50%;
			   left: 50%;
			   width: 50%;
   
			   -webkit-transform: translateX(-50%) translateY(-50%);
			   -moz-transform: translateX(-50%) translateY(-50%);
			   -ms-transform: translateX(-50%) translateY(-50%);
			   transform: translateX(-50%) translateY(-50%);
		   }
		   .linehight{
			   font-size: 14px;
			   font-weight: bold;
		   }
		   .table td, .table th{
			   font-size: 0.75rem !important;
		   }
	   </style>
	</head>
	<body>
				<nav class="navbar is-link" role="navigation" aria-label="main navigation">
			<div class="navbar-brand">
				<a class="navbar-item" href="#">
					<h1 class="title has-text-white">
					DateLY
					</h1>
				</a>
		 
				<a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample" id="bar-btn">
					<span aria-hidden="true"></span>
					<span aria-hidden="true"></span>
					<span aria-hidden="true"></span>
				</a>
			</div>
	
			<div id="navbarBasicExample" class="navbar-menu ">
				<div class="navbar-start">
					<a class="navbar-item ">
						每日新闻
					</a>
							 
					<a class="navbar-item">
						教师资格
					</a>
					
					<a class="navbar-item" herf="index.html" target="_self" onclick="location='index.html'">
						教师招聘
					</a>
					
					<a class="navbar-item" href="book.html" target="_self" onclick="location='book.html'">
						人教版电子教材
					</a>
					
					<a class="navbar-item" href="interview.html" target="_self" onclick="location='interview.html'">
						面试技巧
					</a>
					
					<a class="navbar-item" href="resource.html" target="_self" onclick="location='resource.html'">
						招聘考试资料
					</a>
					
					<a class="navbar-item  is-active" href="music.html" target="_self" onclick="location='music.html'">
						云音乐
					</a>
					
					<a class="navbar-item " herf="https://github.com/dayAndnight2018/teacher/edit/master/dailyEnglish.html" target="_self" onclick="location='dailyEnglish.html'">
						每日一句
					</a>
					
				</div>
			</div>
		</nav>
		
		<div>
			<div id="app" style="width: 100%;height: 100%;">

				<div style="position:fixed;right:10px;bottom:30px;z-index: 997;width: 50px; height: 50px;box-shadow: 1px 1px 2px 2px silver;border-radius:50%;" id="playerBar">
					<i class="fa fa-play-circle" style="display: flex;justify-content: center;align-items: center;color:white;font-size:50px;background: #f47983;width: 100%;height: 100%;border-radius:50%;" v-on:click="showPlayer()"></i>
				</div>
		
				<!-- 这里是显示收藏夹 -->
				<div style="z-index:999;width: 80%;background: white;border: 1px solid silver; border-radius: 0px 0px 8px 8px;box-shadow: 3px 5px 5px silver;display: none; min-height: 120px; max-height: 80%;overflow-y: scroll;" class="ccard" id="card">
					<div style="min-height: 30px;padding:5px;width:100%;background:#f47983;display: flex;flex-direction: row;justify-content: space-between;position: sticky;top: 0px;">
						<div style="font-size: 14px;margin:5px;color:white">
							个人收藏
						</div>
						<div style="display: flex;justify-content: center;align-items: center;">
							<i class="fa fa-window-close" style="font-size:20px;color:white;" @click="closeCard()"></i>
						</div>				
					</div>
					<div v-if="collects.length == 0" style="text-align: center;margin: 20px;font-size:6px;">空空如也~~</div>
					<table class="table is-scripted is-hoverable is-fullwidth" style="width: 90%;margin: 0px auto;">
						<thead style="width: 100%;font-size: 8px;" v-if="collects.length>0"><!--  -->
							<th>歌曲名称</th>
							<th>演唱者</th>
						</thead>
						<tbody style="overflow-y: scroll;margin: 0 auto;width: 100%;font-size: 8px;">
							<tr @click="listen3(music)" style="width: 100%;font-size: 8px;" v-for="music in collects">
								<td style="word-wrap: break-word;word-break: break-all;">{{music.name}}</td>
								<td style="word-wrap: break-word;word-break: break-all;">{{getName(music.artist)}}</td>
							</tr>					
						</tbody>
					</table>
				</div>
		
				<!-- 搜索框 -->
				<div style="position: sticky;top:0px;display:flex;flex-direction: row;justify-content: space-around;width: 100%;background: #fff;padding: 10px;border-top:0px;z-index: 777;" id="searchArea">
					<input class="input" type="text" placeholder="请输入歌曲名称" id="searchInput" v-on:keyup.enter="search()"/>
					<span style="padding-left: 20px;"><button class="button" style="background: #f47983;color: white" @click="search()">搜索</button></span>
				</div>
		
				<!-- 播放列表 -->
				<div style="padding: 10px;width:100%;display:flex;flex-direction:column;align-items:center;margin-bottom:120px;z-index: 777;" id="listArea">
					<table class="table is-scripted is-hoverable is-fullwidth">
						<thead style="width: 100%;" v-if="musics.length>0"><!--  -->
							<th>歌曲名称</th>
							<th>演唱者</th>
						</thead>
						<tbody style="overflow-y: scroll;margin: 0 auto;width: 100%;">
							<tr @click="listen4(music)" style="width: 100%;" v-for="music in musics">
								<td style="word-wrap: break-word;word-break: break-all;">{{music.name}}</td>
								<td style="word-wrap: break-word;word-break: break-all;">{{getName(music.artist)}}</td>
							</tr>		
							<tr>
							  <td colspan="2" style="text-align:center"><a style="text-align:center;width:100%;color:red" v-on:click="next()" >···加载更多···</a></td>
							</tr>				
						</tbody>
					</table>
				</div>
		
				
		
				<!-- 播放器 -->
				<div style="z-index: 888;background: #f47983;filter: blur(0.5px);height: 100%;width: 100%;position: relative; display: none;" id="playCard">
					<div style="background: rgba(0,0,0,0.6);z-index: 998;height: 100%;width: 100%;">
					<div style="width: 100%;">
						
						<i class="fa fa-chevron-left" style="font-size: 30px;color: white;margin-left: 10px;margin-top: 20px;" v-on:click="hidePlayCard()"></i>
						<div style="color: white;font-size: 16px;padding:5px;text-align: center;width: 100%;" id="title">歌曲名称</div> 
						<div style="color: white;font-size: 12px;padding:5px;text-align: center;width: 100%;" id="author">
						演唱者
						</div> 
					</div>
		
					<div style="text-align: center;width: 100%;margin-top: 20px;">
						<a id='download' style="display:block;margin:10px"><img id="image" src="https://p1.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg" style="width: 200px; height: 200px;box-shadow: 1px 1px 2px 2px white;border-radius:50%"/></a>
					</div>
					
		
					<!-- 歌词部分 -->
					<div style="width: 100%;color: white;text-align: center;max-height: 200px;overflow-y: hidden;margin-top: 50px;">
						<ul id="lyric" style="text-decoration: none;font-size: 12px;font-family:楷体;">
						</ul>
					</div>		
		
					<div style="width: 100%;padding: 5px;display: flex;flex-direction: column;align-items: center;background: white;position: absolute;bottom: 0px;box-shadow: 3px 3px 5px 5px silver;">
						<div style="width: 100%;padding: 2px 5px 2px 5px;margin: 0px auto;">
							<P id="str" style="float: left;margin-left: 5px;font-size: .25rem">00:00</P>
							<P id="end" style="float: right;margin-right: 5px;font-size: .25rem">00:00</P>
							<progress class="progress is-danger is-small" value="0" max="100" id="playProgress" style="height: 2px;width: 98%;margin: 0 auto;">|</progress> 
						</div>
						<div style="padding: 5px;display: flex;flex-direction: row;align-items: center;width: 100%;">
							<i class="fa fa-step-backward" style="margin: 0px 8px;color:rgb(0, 0, 0);" v-on:click="lastSong()"></i>
							<div style="font-size: 15px;margin: 0px 8px;color: black;" id="playControl" v-on:click="listen2()">▶</div>
							<i class="fa fa-step-forward" style="margin: 0px 8px;color:rgb(0, 0, 0);" v-on:click="nextSong()"></i>
							<i class="fa fa-stop" style="margin: 0px 8px;color:rgb(0, 0, 0);" v-on:click="stop()"></i>
							<div style="display: flex;flex-direction: row;position: absolute;right: 15px;">
								<i id="playModeTag" class="fa fa-exchange" style="margin: 0px 5px;color:rgb(0, 0, 0);" v-on:click="playMode()"></i>
								<i class="fi-list" style="margin: 0px 5px;color:rgb(244, 121, 131);" v-on:click="toggleCard()"></i>
								<i class="fi-heart" style="margin: 0px 5px;" :class="{'mactive': exists}" v-on:click="collect()"></i>
							</div>
						</div>
					</div>
		
					<div>
						<audio autoplay="autoplay" controls="controls"  id="player" style="display: none;">
							<source id="source" ></source>
						</audio>
					</div>
				  </div>
				</div>
		</div>
	</div>
		
		<script>
		
				var lineNo = 0;
		
				function searchCallback(rdata) {
					$("#btns").show();
					vue.musics = rdata;
				};
				function searchCallback2(rdata) {			
					vue.musics = vue.musics.concat(rdata);
					vue.playList = vue.musics;		
				};
				function picCallback(rdata) {
					$("#image").attr("src",rdata.url);
					$("#playCard").css("background-image", "url("+rdata.url+')');
				};
				function songCallback(rdata) {
					if(rdata.url == ""){
						if(vue.mode == 1){
							vue.current = null;
							$("#player")[0].currentTime = 0;
							$("#playControl").html("▶");
							alert("资源不存在, 请播放其他资源");
							return;
						}
						if(vue.playList.length > 0){
							if(vue.mode == 2){
								if(vue.currentIndex == vue.playList.length - 1){
									$("#player")[0].currentTime = 0;
									return;
								}
								vue.currentIndex += 1;
								vue.listen(vue.playList[vue.currentIndex]);
							}else if(vue.mode == 3){
								vue.listen(vue.playList[Math.floor((Math.random()*vue.playList.length))]);
							}
						}				
						return;		
					}
					$("#player").attr("src",rdata.url);
					$("#download").attr("download",$("#title").html());
					$("#download").attr("href",rdata.url);
					$("#player")[0].play();
					$("#playerBar").addClass("rotate");
				};
		
				function lrcCallback(rdata) {			
					vue.createLrcObj(rdata.lyric);
				};	
		
				var linehight = function (lineno) {
					var ul = $("#lyric");
					var $ul = document.getElementById('lyric');
				 
					if (lineno > 0) {
						$(ul.find("li").get(topNum + lineno - 1)).removeClass("lineheight");
					}
					var nowline = ul.find("li").get(topNum + lineno);
					$(nowline).addClass("lineheight");
				 
					var _scrollTop;
					$ul.scrollTop = 0;
					if ($ul.clientHeight * fraction > nowline.offsetTop) {
						_scrollTop = 0;
					} else if (nowline.offsetTop > ($ul.scrollHeight - $ul.clientHeight * (1 - fraction))) {
						_scrollTop = $ul.scrollHeight - $ul.clientHeight;
					} else {
						_scrollTop = nowline.offsetTop - $ul.clientHeight * fraction;
					}
				 
				 
					//以下声明歌词高亮行固定的基准线位置成为 “A”
					if ((nowline.offsetTop - $ul.scrollTop) >= $ul.clientHeight * fraction) {
						//如果高亮显示的歌词在A下面，那就将滚动条向下滚动，滚动距离为 当前高亮行距离顶部的距离-滚动条已经卷起的高度-A到可视窗口的距离
						$ul.scrollTop += Math.ceil(nowline.offsetTop - $ul.scrollTop - $ul.clientHeight * fraction);
				 
					} else if ((nowline.offsetTop - $ul.scrollTop) < $ul.clientHeight * fraction && _scrollTop != 0) {
						//如果高亮显示的歌词在A上面，那就将滚动条向上滚动，滚动距离为 A到可视窗口的距离-当前高亮行距离顶部的距离-滚动条已经卷起的高度
						$ul.scrollTop -= Math.ceil($ul.clientHeight * fraction - (nowline.offsetTop - $ul.scrollTop));
				 
					} else if (_scrollTop == 0) {
						$ul.scrollTop = 0;
					} else {
						$ul.scrollTop += $(ul.find('li').get(0)).height();
					}
				 
				}	
		
				var vue = new Vue({
					el:"#app",
					data:{
						page:1,
						musics:[],
						exists:false,
						current:null,
						collects:[],
						oLRC:{
							ti: "", //歌曲名
							ar: "", //演唱者
							al: "", //专辑名
							by: "", //歌词制作人
							offset: 0, //时间补偿值，单位毫秒，用于调整歌词整体位置
							ms: [] //歌词数组{t:时间,c:歌词}
						},
						playList:[],
						currentIndex:0,
						mode: 1
					},
					mounted(){
						var colls = JSON.parse(localStorage.getItem('collects'));
						if(colls != null && colls != undefined && colls.length > 0){
							this.collects = colls.concat();
						}
					},
					methods:{
						showPlayer:function(){
							$("#searchArea").hide();
							$("#listArea").hide();	
							$("#playerBar").hide();			
							$("#playCard").show();
						},
						lastSong: function(){
							if(vue.mode == 1){
								$("#player")[0].currentTime = 0;
								return;
							}
							if(vue.playList.length > 0){
								if(vue.mode == 2){
									if(vue.currentIndex == 0){
										$("#player")[0].currentTime = 0;
										return;
									}
									vue.currentIndex -= 1;
									vue.listen(vue.playList[vue.currentIndex]);
								}else if(vue.mode == 3){
									vue.listen(vue.playList[Math.floor((Math.random()*vue.playList.length))]);
								}
							}
						},
						nextSong: function(){
							if(vue.mode == 1){
								$("#player")[0].currentTime = 0;
								return;
							}
							if(vue.playList.length > 0){
								if(vue.mode == 2){
									if(vue.currentIndex == vue.playList.length - 1){
										$("#player")[0].currentTime = 0;
										return;
									}
									vue.currentIndex += 1;
									vue.listen(vue.playList[vue.currentIndex]);
								}else if(vue.mode == 3){
									vue.listen(vue.playList[Math.floor((Math.random()*vue.playList.length))]);
								}
							}
						},
						stop:function(){
							$("#player")[0].pause();
							$("#playerBar").removeClass("rotate");
							$("#player")[0].currentTime = 0;
							$("#playControl").html("▶");
						},
						playMode:function(){
							if($("#playModeTag").hasClass("fa-exchange"))
							{
								$("#playModeTag").removeClass("fa-exchange");
								$("#playModeTag").addClass("fa-level-down");
								vue.mode = 2;
		
							}else if($("#playModeTag").hasClass("fa-level-down"))
							{
								$("#playModeTag").removeClass("fa-level-down");
								$("#playModeTag").addClass("fa-random");
								vue.mode = 3;
		
							}else if($("#playModeTag").hasClass("fa-random"))
							{
								$("#playModeTag").removeClass("fa-random");
								$("#playModeTag").addClass("fa-exchange");
								vue.mode = 1;
							}
						},
						listen3:function(music){
							this.playList = this.collects;
							for (var i = 0; i < this.collects.length; i++) {
								if (this.collects[i].url_id == music.url_id) {
								   this.currentIndex = i;
								   break;
								}
							}
							this.listen(music);
							
						},
						listen4:function(music){
							this.playList = this.musics;
							for (var i = 0; i < this.musics.length; i++) {
								if (this.musics[i].url_id == music.url_id) {
								   this.currentIndex = i;
								   break;
								}
							}
							this.listen(music);
							
						},
						last: function(){
							if(this.page==1) return;
							this.page--;
							var text = $("#searchInput").val();
							if(text == "")
							{
								alert("请输入歌曲名称!");
								return;
							}
		
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "searchCallback",    // 自定义回调函数名
									data: {types:'search',count:20,source:'netease',pages:this.page,name:text}
								});
						},
						closeCard: function(){
							$("#card").hide();
						  },
						  toggleCard:function(){
							  $("#card").show();
						  },
						next: function(){
		
							this.page++;
							var text = $("#searchInput").val();
							if(text == "")
							{
								alert("请输入歌曲名称!");
								return;
							}
		
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "searchCallback2",    // 自定义回调函数名
									data: {types:'search',count:20,source:'netease',pages:this.page,name:text}
								});
						},
						search: function(){
							this.page = 1;
							var text = $("#searchInput").val();
							if(text == "")
							{
								alert("请输入歌曲名称!");
								return;
							}
		
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "searchCallback",    // 自定义回调函数名
									data: {types:'search',count:20,source:'netease',pages:this.page,name:text}
								});
		
						},
		
						getName: function(names){
							var name = "";
							for(var i = 0; i < names.length; i++){
								name += names[i];
								if(i != names.length-1){
									name += "&"
								}
							}
							return name;
						},
						getLength: function(duration){
							var dur = duration / 1000;
							return parseInt(dur / 60) +":"+ parseInt(dur % 60);
						},
						collect:function(){					
							var tempCurrent = this.current;
							if(tempCurrent == null){
								return;
							}
							
							var cMusic = this.collects.find((a)=>a.url_id == tempCurrent.url_id);
							if(cMusic == null){
								this.collects.push(tempCurrent);
								vue.exists = true ;
							}else{
								this.collects = this.collects.filter((a)=>a.url_id != cMusic.url_id);
								vue.exists = false ;
							}
							localStorage.setItem('collects',JSON.stringify(this.collects));
		
						},
						createLrcObj:function(lrc) {
							if(lrc.length==0) 
								return;
		
							this.oLRC.ti=""; //歌曲名
							this.oLRC.ar=""; //演唱者
							this.oLRC.al=""; //专辑名
							this.oLRC.by=""; //歌词制作人
							this.oLRC.offset=0; //时间补偿值，单位毫秒，用于调整歌词整体位置
							this.oLRC.ms=[]; //歌词数组{t:时间,c:歌词}
							var lrcs = lrc.split('\n');//用回车拆分成数组
							for(var i in lrcs) {//遍历歌词数组
								lrcs[i] = lrcs[i].replace(/(^\s*)|(\s*$)/g, ""); //去除前后空格
								var t = lrcs[i].substring(lrcs[i].indexOf("[") + 1, lrcs[i].indexOf("]"));//取[]间的内容
								var s = t.split(":");//分离:前后文字
								if(isNaN(parseInt(s[0]))) { //不是数值
									for (var i in this.oLRC) {
										if (i != "ms" && i == s[0].toLowerCase()) {
											this.oLRC[i] = s[1];
										}
									}
								}else { //是数值
									var arr = lrcs[i].match(/\[(\d+:.+?)\]/g);//提取时间字段，可能有多个
									var start = 0;
									for(var k in arr){
										start += arr[k].length; //计算歌词位置
									}
									var content = lrcs[i].substring(start);//获取歌词内容
									for (var k in arr){
										var t = arr[k].substring(1, arr[k].length-1);//取[]间的内容
										var s = t.split(":");//分离:前后文字
										this.oLRC.ms.push({//对象{t:时间,c:歌词}加入ms数组
											t: (parseFloat(s[0])*60+parseFloat(s[1])).toFixed(3),
											c: content
										});
									}
								}
							}
							this.oLRC.ms.sort(function (a, b) {//按时间顺序排序
								return a.t-b.t;
							});
							/*
							for(var i in oLRC){ //查看解析结果
								console.log(i,":",oLRC[i]);
							}*/
						},
						showLRC: function(current) {
							if(this.oLRC.ms.length == 0){
								return;
							}
							var s="";
							var index = 0;
							for(var i in this.oLRC.ms){//遍历ms数组，把歌词加入列表
								if(this.oLRC.ms[i].t <= current){
									index ++;
								}else{
									break;
								}			    	
							}
		
							if(index > 5){
								s+='<li>'+this.oLRC.ms[index - 5].c+'</li>';
								s+='<li>'+this.oLRC.ms[index - 4].c+'</li>';
								s+='<li>'+this.oLRC.ms[index - 3].c+'</li>';
								s+='<li>'+this.oLRC.ms[index -2].c+'</li>';
								s+='<li class="linehight">'+this.oLRC.ms[index-1].c+'</li>';
							}else{
								for(var i = 0; i< index ;i++){
									if(i == index -1){
										s+='<li class="linehight">'+this.oLRC.ms[i].c+'</li>';
									}else{
										s+='<li>'+this.oLRC.ms[i].c+'</li>';
									}			    	
								}
							}			    
							document.getElementById("lyric").innerHTML = s;
						},
						hidePlayCard:function(){
							$("#playCard").hide();
							$("#searchArea").show();
							$("#listArea").show();
							$("#playerBar").show();	
						},
						listen2:function(){
							if(this.current == null || this.current.url_id == ""){
								return;
							}
							if($("#playControl").html() == "||"){
								$("#player")[0].pause();
								$("#playerBar").removeClass("rotate");
								$("#playControl").html("▶");
							}else{
								$("#player")[0].play();
								$("#playerBar").addClass("rotate");
								$("#playControl").html("||");
							}
						},
						listen: function(music){	
							$("#searchArea").hide();
							$("#listArea").hide();	
							$("#playerBar").hide();				
							if(this.current != null && this.current.url_id == music.url_id){
								$("#playCard").show();
								this.listen2();	
								return;
							}
							$("#player")[0].pause();
							$("#playerBar").removeClass("rotate");
							var auth = vue.getName(music.artist);
							$("#title").html(music.name);					
							$("#author").html(auth);
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "picCallback",    // 自定义回调函数名
									data: {types:'pic',id:music.pic_id,source:'netease'}
								});
		
		
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
								  async:false,
									jsonpCallback: "songCallback",    // 自定义回调函数名
									data: {types:'url',id:music.url_id,source:'netease'}
								});
		
							$.ajax({
								url: 'http://music.runker.net/api.php',
								type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "lrcCallback",    // 自定义回调函数名
									data: {types:'lyric',id:music.lyric_id,source:'netease'}
								});
		
							var tempCurrent = this.current = music;
							var cMusic = this.collects.find((a)=>a.url_id == tempCurrent.url_id);
							if(cMusic == null){
								vue.exists = false ;
							}else{
								vue.exists = true ;
							}
		
							if(this.oLRC.ms.length > 0){
		
							}
		
							$("#playControl").html("||");
							$("#playCard").show();					
						}
					}
				});
		
				function format(time)
				{
					var time=parseInt(time);
					var m=parseInt(time/60);
					var s=parseInt(time%60);
					m=zero(m);
					s=zero(s);
					function zero(num)
					{
						if(num<10)
						{
							num="0"+num;
						}
						return num;
					}
					return m+":"+s;
				}
					
				$("#searchInput").val("最新");
				$.ajax({
					url: 'http://music.runker.net/api.php',
					type: 'post',
									dataType: 'jsonp',  // 请求方式为jsonp
									jsonpCallback: "searchCallback",    // 自定义回调函数名
									data: {types:'search',count:20,source:'netease',pages:1,name:"最新"}
				});
		
				$("#player")[0].addEventListener("timeupdate",function()
				{
					var audio = $("#player")[0];
					if(audio.currentTime==audio.duration)
					{
						$("#playControl").html("▶");            	
					}
					var n=audio.currentTime/audio.duration * 100;
					$("#playProgress").val(Math.round(n));
					 $("#str").html(format(audio.currentTime));
					 $("#end").html(format(audio.duration));
					 vue.showLRC(audio.currentTime);
				})
		
				var aud = document.getElementById("player");
				aud.onended = function() {
					if(vue.playList.length > 0){
						if(vue.mode == 1){
							vue.listen(vue.current);
						}else if(vue.mode == 2){
							if(vue.currentIndex == vue.playList.length -1){
								// aud.pause();
								$("#playerBar").removeClass("rotate");
								return;
							}
							vue.currentIndex += 1;
							vue.listen(vue.playList[vue.currentIndex]);
						}else if(vue.mode == 3){
							vue.listen(vue.playList[Math.floor((Math.random()*vue.playList.length))]);
						}
					}
				};
		
				//点击进度条位置
				$("#playProgress").click(function(ev)
				{
					var ev=ev||window.event;
					var audio = $("#player")[0];
					var x = ev.pageX - this.offsetLeft;
					audio.currentTime = x / this.offsetWidth * audio.duration;
				});
				</script>
	</body>
</html>
